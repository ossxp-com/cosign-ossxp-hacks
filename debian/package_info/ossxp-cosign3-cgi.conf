file: /etc/apache2/include/https/cosign-cgi.conf
type: host
regex:
    * cosignhost
      * match: ^(?P<_begin>RedirectMatch\s+.*\s+)(?:https://(?P<host_single_sign_on>[\w.-]*))?(?P<_end>/.*)
      * replacement: \g<_begin>https://\g<host_single_sign_on>\g<_end>

file: /opt/cosign/conf/config.py
type: host
regex:
    * ldap url
      * match: (?P<_begin>\bldap_uri\s*=\s*['"]ldaps?://)(?P<host_ldap_server>[\w.-]*)(:(?P<number_ldap_port>[0-9]*))?
      * replacement(number_ldap_port, 1): \g<_begin>\g<host_ldap_server>:\g<number_ldap_port>
      * replacement(number_ldap_port, 0): \g<_begin>\g<host_ldap_server>
    * ldap basedn
      * match: (?P<_begin>\bldap_base\s*=\s*['"])(?P<name_ldap_basedn>[^'"]*)
      * replacement: \g<_begin>\g<name_ldap_basedn>
    * ldap bind user
      * match: (?P<_begin>\bldap_binddn\s*=\s*['"])(?P<password_ldap_ro_binduser>[^'"]*)
      * replacement: \g<_begin>\g<password_ldap_ro_binduser>
    * ldap bind password
      * match: (?P<_begin>\bldap_bindpw\s*=\s*['"])(?P<password_ldap_ro_bindpw>[^'"]*)
      * replacement: \g<_begin>\g<password_ldap_ro_bindpw>

file: /opt/cosign/factor/ldap
type: host
regex:
    * ldap basedn
      * match: (?P<_begin>\bmy\s+\$base\s*=\s*['"])(?P<name_ldap_basedn>[^'"]*)
      * replacement: \g<_begin>\g<name_ldap_basedn>
    * ldap host
      * match: (?P<_begin>\bmy\s+\$host\s*=\s*['"]ldaps?://)(?P<host_ldap_server>[\w.-]*)(:(?P<number_ldap_port>[0-9]*))?
      * replacement(number_ldap_port, 1): \g<_begin>\g<host_ldap_server>:\g<number_ldap_port>
      * replacement(number_ldap_port, 0): \g<_begin>\g<host_ldap_server>
    * ldap bind user
      * match: (?P<_begin>\bmy\s+\$binddn\s*=\s*['"])(?P<password_ldap_ro_binduser>[^'"]*)
      * replacement: \g<_begin>\g<password_ldap_ro_binduser>
    * ldap bind password
      * match: (?P<_begin>\bmy\s+\$bindpw\s*=\s*['"])(?P<password_ldap_ro_bindpw>[^'"]*)
      * replacement: \g<_begin>\g<password_ldap_ro_bindpw>

file: /opt/cosign/lib/services-local/config_inc.php
type: host, number
regex:
    * virtual host
      * match: (?P<_begin>\$url_gosa\s*=\s*['"]https?://)(?P<host_virtual_host_gosa>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_gosa>
    * virtual host
      * match: (?P<_begin>\$url_logout\s*=\s*['"]https?://)(?P<host_single_sign_on>[\w.-]*)
      * replacement: \g<_begin>\g<host_single_sign_on>
    * ldap server
      * match: (?P<_begin>\$g_ldap_server\s*=\s*['"]ldaps?://)(?P<host_ldap_server>[\w.-]*)(:(?P<number_ldap_port>[0-9]*))?
      * replacement(number_ldap_port, 1): \g<_begin>\g<host_ldap_server>:\g<number_ldap_port>
      * replacement(number_ldap_port, 0): \g<_begin>\g<host_ldap_server>
    * ldap port
      * match: (?P<_begin>\$g_ldap_port\s*=\s*['"])(?P<number_ldap_port>[0-9]*)
      * replacement: \g<_begin>\g<number_ldap_port>
    * ldap root dn
      * match: (?P<_begin>\$g_ldap_root_dn\s*=\s*['"])(?P<name_ldap_basedn>[^'"]*)
      * replacement: \g<_begin>\g<name_ldap_basedn>
    * ldap bind dn
      * match: (?P<_begin>\$g_ldap_bind_dn\s*=\s*['"])(?P<password_ldap_ro_binduser>[^'"]*)
      * replacement: \g<_begin>\g<password_ldap_ro_binduser>
    * ldap bind password
      * match: (?P<_begin>\$g_ldap_bind_passwd\s*=\s*['"])(?P<password_ldap_ro_bindpw>[^'"]*)
      * replacement: \g<_begin>\g<password_ldap_ro_bindpw>

file: /etc/hosts
type: ip
regex:
    * cosign-client
      * match: ^(?:#\s*OPM/COMMENT\s*)?(?P<ip_cosign_client1>[0-9.]*)(?P<_end>\s+cosign-client1)\s*$
      * replacement(ip_cosign_client1,1): \g<ip_cosign_client1>\g<_end>
      * replacement(ip_cosign_client1,0): 127.0.0.3\g<_end>
      #* replacement(ip_cosign_client1,0): #OPM/COMMENT \g<_end>


file: /opt/cosign/lib/templates-local/en/expired_error.html, /opt/cosign/lib/templates-local/en/reauth.html, /opt/cosign/lib/templates-local/en/login.html, /opt/cosign/lib/templates-local/en/login_error.html, /opt/cosign/lib/templates-local/zh/expired_error.html, /opt/cosign/lib/templates-local/zh/reauth.html, /opt/cosign/lib/templates-local/zh/login.html, /opt/cosign/lib/templates-local/zh/login_error.html
type: host
regex:
    * vritual host
      * match: ^(?P<_begin>\s+<a href=['"]https?://)(?P<host_single_sign_on>[\w.-]*)(?P<_end>/?['"]>)$
      * replacement: \g<_begin>\g<host_single_sign_on>\g<_end>
    * vritual host
      * match: (?P<_begin><a href=['"]https?://)(?P<host_virtual_host_gosa>[\w.-]*)(?P<_end>/.*signup.php['"])
      * replacement: \g<_begin>\g<host_virtual_host_gosa>\g<_end>

file: /opt/cosign/lib/templates-local/inc/en/0010_wiki.html, /opt/cosign/lib/templates-local/inc/zh/0010_wiki.html
type: host
regex:
    * vritual host
      * match: (?P<_begin><a name="wiki" href=['"]https?://)(?P<host_virtual_host_wiki>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_wiki>

file: /opt/cosign/lib/templates-local/inc/en/0015_blog.html, /opt/cosign/lib/templates-local/inc/zh/0015_blog.html
type: host
regex:
    * vritual host
      * match: (?P<_begin><a name="blog" href=['"]https?://)(?P<host_virtual_host_blog>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_blog>

file: /opt/cosign/lib/templates-local/inc/en/0020_scm.html, /opt/cosign/lib/templates-local/inc/zh/0020_scm.html
type: host
regex:
    * vritual host
      * match: (?P<_begin><a name="websvn" href=['"]https?://)(?P<host_virtual_host_websvn>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_websvn>
    * vritual host
      * match: (?P<_begin><a name="statsvn" href=['"]https?://)(?P<host_virtual_host_statsvn>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_statsvn>
    * vritual host
      * match: (?P<_begin><a name="git" href=['"]https?://)(?P<host_virtual_host_git>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_git>
    * vritual host
      * match: (?P<_begin><a name="hg" href=['"]https?://)(?P<host_virtual_host_hg>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_hg>

file: /opt/cosign/lib/templates-local/inc/en/0030_bugtrac.html, /opt/cosign/lib/templates-local/inc/zh/0030_bugtrac.html
type: host
regex:
    * vritual host
      * match: (?P<_begin><a name="trac" href=['"]https?://)(?P<host_virtual_host_trac>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_trac>
    * vritual host
      * match: (?P<_begin><a name="redmine" href=['"]https?://)(?P<host_virtual_host_redmine>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_redmine>

file: /opt/cosign/lib/templates-local/inc/en/0035_testlink.html, /opt/cosign/lib/templates-local/inc/zh/0035_testlink.html
type: host
regex:
    * vritual host
      * match: (?P<_begin><a name="testlink" href=['"]https?://)(?P<host_virtual_host_testlink>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_testlink>

file: /opt/cosign/lib/templates-local/inc/en/0040_comm.html, /opt/cosign/lib/templates-local/inc/zh/0040_comm.html
type: host
regex:
    * vritual host
      * match: (?P<_begin><a name="mailman" href=['"]https?://)(?P<host_virtual_host_list>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_list>

file: /opt/cosign/lib/templates-local/inc/en/1000_account.html, /opt/cosign/lib/templates-local/inc/zh/1000_account.html
type: host
regex:
    * vritual host
      * match: (?P<_begin><a name="gosa" href=['"]https?://)(?P<host_virtual_host_gosa>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_gosa>
    * vritual host
      * match: (?P<_begin><a name="sso" href=['"]https?://)(?P<host_single_sign_on>[\w.-]*)
      * replacement: \g<_begin>\g<host_single_sign_on>
