prefix=@prefix@
LOCALEDIR=@localedir@
DESTDIR=
INSTALL=     @INSTALL@
MAIN_POT=cosign.pot
SUB_POT=addition.pot

TARGETS=zh

all: mo

pot: $(MAIN_POT)
cosign.pot: $(wildcard ../cgi/*.c)
	xgettext -s -k_ -o $@ $^

po: pot
	for i in ${TARGETS}; do \
	    msgmerge  -s -o $$i/LC_MESSAGES/MAIN_POT.po $$i/LC_MESSAGES/cosign.po $(MAIN_POT); \
	    msgmerge  -s -o $$i/LC_MESSAGES/SUB_POT.po  $$i/LC_MESSAGES/cosign.po $(SUB_POT); \
	    msgcat    -s -o $$i/LC_MESSAGES/NEW_POT.po  $$i/LC_MESSAGES/MAIN_POT.po $$i/LC_MESSAGES/SUB_POT.po ; \
	done

mo:
	for i in ${TARGETS}; do \
	  (cd $$i/LC_MESSAGES; msgfmt -o cosign.mo cosign.po); \
	done

clean:
	-@for i in ${TARGETS}; do \
		(cd $$i/LC_MESSAGES; rm -f cosign.mo); \
		done

install : all
	-mkdir -p $(DESTDIR)${LOCALEDIR}
	cp -a cosign.pot ${TARGETS} $(DESTDIR)${LOCALEDIR}

.PHONY: pot mo clean all install

# vim: noet ts=4 sw=4
