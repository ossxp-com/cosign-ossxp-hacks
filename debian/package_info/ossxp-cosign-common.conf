directory: /opt/cosign/conf
type: backup

directory: /opt/cosign/factor
type: backup

directory: /opt/cosign/lib
type: backup

file: /opt/cosign/conf/cosign.conf
type: host
regex:
    * cosignhost
      * match: ^(?P<_begin>set\s+cosignhost\s+)(?P<host_cosign_daemon>.*)
      * replacement: \g<_begin>\g<host_cosign_daemon>
    * cosign logout url
      * match: ^(?P<_begin>set\s+cosignlogouturl\s+https?://)(?P<host_single_sign_on>[\w.-]*)
      * replacement: \g<_begin>\g<host_single_sign_on>
    * cosign login url
      * match: ^(?P<_begin>set\s+cosignloopurl\s+https?://)(?P<host_single_sign_on>[\w.-]*)
      * replacement: \g<_begin>\g<host_single_sign_on>

file: /etc/apache2/include/cosign/cosign-common.conf
type: host
regex:
    * cosignhost
      * match: ^(?P<_begin>CosignHostname\s+)(?P<host_cosign_daemon>.*)
      * replacement: \g<_begin>\g<host_cosign_daemon>
    * cosign redirect
      * match: ^(?P<_begin>CosignRedirect\s+https?://)(?P<host_single_sign_on>[\w.-]*)
      * replacement: \g<_begin>\g<host_single_sign_on>
    * cosign post error redirect
      * match: ^(?P<_begin>CosignPostErrorRedirect\s+https?://)(?P<host_single_sign_on>[\w.-]*)
      * replacement: \g<_begin>\g<host_single_sign_on>

file: /etc/apache2/sites-available/cosign-cgi
regex:
    * server admin
      * match: (?P<_begin>\bServerAdmin)(?:\s+(?P<email_webmaster>.*))?
      * replacement: \g<_begin> \g<email_webmaster>
    * server name
      * match: (?P<_begin>\bServerName)(?:\s+(?P<host_single_sign_on>[\w.-]*))?
      * replacement: \g<_begin> \g<host_single_sign_on>
    * redirect
      * match: (?P<_begin>\bRedirect\s+/\s+https://)(?P<host_single_sign_on>[\w.-]*)
      * replacement: \g<_begin>\g<host_single_sign_on>

file: /etc/apache2/include/http/010_cosign_cgi.conf
regex:
    * redirect
      * match: (?P<_begin>RedirectMatch\s+\^/\$\s+https?://)(?P<host_single_sign_on>[\w.-]*)
      * replacement: \g<_begin>\g<host_single_sign_on>

file: /opt/cosign/factor/ldap
type: host
regex:
    * ldap basedn
      * match: (?P<_begin>\bmy\s+\$base\s*=\s*['"])(?P<name_ldap_basedn>[^'"]*)
      * replacement: \g<_begin>\g<name_ldap_basedn>
    * ldap host
      * match: (?P<_begin>\bmy\s+\$host\s*=\s*['"]ldaps?://)(?P<host_ldap_server>[\w.-]*)(:(?P<number_ldap_port>[0-9]*))?
      * replacement(number_ldap_port, 1): \g<_begin>\g<host_ldap_server>:\g<number_ldap_port>
      * replacement(number_ldap_port, 0): \g<_begin>\g<host_ldap_server>
    * ldap bind user
      * match: (?P<_begin>\bmy\s+\$binddn\s*=\s*['"])(?P<password_ldap_ro_binduser>[^'"]*)
      * replacement: \g<_begin>\g<password_ldap_ro_binduser>
    * ldap bind password
      * match: (?P<_begin>\bmy\s+\$bindpw\s*=\s*['"])(?P<password_ldap_ro_bindpw>[^'"]*)
      * replacement: \g<_begin>\g<password_ldap_ro_bindpw>

file: /opt/cosign/lib/services-local/config_inc.php
type: host, number
regex:
    * virtual host
      * match: (?P<_begin>\$url_gosa\s*=\s*['"]https?://)(?P<host_virtual_host_gosa>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_gosa>
    * virtual host
      * match: (?P<_begin>\$url_wiki\s*=\s*['"]https?://)(?P<host_virtual_host_wiki>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_wiki>
    * virtual host
      * match: (?P<_begin>\$url_websvn\s*=\s*['"]https?://)(?P<host_virtual_host_websvn>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_websvn>
    * virtual host
      * match: (?P<_begin>\$url_mercurial\s*=\s*['"]https?://)(?P<host_virtual_host_hg>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_hg>
    * virtual host
      * match: (?P<_begin>\$url_statsvn\s*=\s*['"]https?://)(?P<host_virtual_host_statsvn>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_statsvn>
    * virtual host
      * match: (?P<_begin>\$url_bugs\s*=\s*['"]https?://)(?P<host_virtual_host_trac>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_trac>
    * virtual host
      * match: (?P<_begin>\$url_mailman\s*=\s*['"]https?://)(?P<host_virtual_host_list>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_list>
    * virtual host
      * match: (?P<_begin>\$url_login\s*=\s*['"]https?://)(?P<host_single_sign_on>[\w.-]*)
      * replacement: \g<_begin>\g<host_single_sign_on>
    * virtual host
      * match: (?P<_begin>\$url_logout\s*=\s*['"]https?://)(?P<host_single_sign_on>[\w.-]*)
      * replacement: \g<_begin>\g<host_single_sign_on>
    * virtual host
      * match: (?P<_begin>\$url_lostpwd\s*=\s*['"]https://)(?P<host_virtual_host_gosa>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_gosa>
    * virtual host
      * match: (?P<_begin>\$url_signup\s*=\s*['"]https?://)(?P<host_virtual_host_gosa>[\w.-]*)
      * replacement: \g<_begin>\g<host_virtual_host_gosa>
    * ldap server
      * match: (?P<_begin>\$g_ldap_server\s*=\s*['"]ldaps?://)(?P<host_ldap_server>[\w.-]*)(:(?P<number_ldap_port>[0-9]*))?
      * replacement(number_ldap_port, 1): \g<_begin>\g<host_ldap_server>:\g<number_ldap_port>
      * replacement(number_ldap_port, 0): \g<_begin>\g<host_ldap_server>
    * ldap port
      * match: (?P<_begin>\$g_ldap_port\s*=\s*['"])(?P<number_ldap_port>[0-9]*)
      * replacement: \g<_begin>\g<number_ldap_port>
    * ldap root dn
      * match: (?P<_begin>\$g_ldap_root_dn\s*=\s*['"])(?P<name_ldap_basedn>[^'"]*)
      * replacement: \g<_begin>\g<name_ldap_basedn>
    * ldap bind dn
      * match: (?P<_begin>\$g_ldap_bind_dn\s*=\s*['"])(?P<password_ldap_ro_binduser>[^'"]*)
      * replacement: \g<_begin>\g<password_ldap_ro_binduser>
    * ldap bind password
      * match: (?P<_begin>\$g_ldap_bind_passwd\s*=\s*['"])(?P<password_ldap_ro_bindpw>[^'"]*)
      * replacement: \g<_begin>\g<password_ldap_ro_bindpw>

file: /opt/cosign/lib/templates-local/expired_error.html, /opt/cosign/lib/templates-local/reauth.html, /opt/cosign/lib/templates-local/login.html, /opt/cosign/lib/templates-local/login_error.html, /opt/cosign/lib/templates-local/zh/expired_error.html, /opt/cosign/lib/templates-local/zh/reauth.html, /opt/cosign/lib/templates-local/zh/login.html, /opt/cosign/lib/templates-local/zh/login_error.html
type: host
regex:
    * vritual host
      * match: ^(?P<_begin>\s+<a href=['"]https?://)(?P<host_single_sign_on>[\w.-]*)(?P<_end>/?['"]>)$
      * replacement: \g<_begin>\g<host_single_sign_on>\g<_end>
    * vritual host
      * match: (?P<_begin><a href=['"]https?://)(?P<host_virtual_host_gosa>[\w.-]*)(?P<_end>/.*signup.php['"])
      * replacement: \g<_begin>\g<host_virtual_host_gosa>\g<_end>
    * vritual host
      * match: (?P<_begin><a href=['"]https?://)(?P<host_virtual_host_wiki>[\w.-]*)(?P<_end>/.*action/login/.*\?action=login&login=1['"])
      * replacement: \g<_begin>\g<host_virtual_host_wiki>\g<_end>
    * vritual host
      * match: (?P<_begin><a href=['"]https?://)(?P<host_virtual_host_websvn>[\w.-]*)(?P<_end>/websvn/['"])
      * replacement: \g<_begin>\g<host_virtual_host_websvn>\g<_end>
    * vritual host
      * match: (?P<_begin><a href=['"]https?://)(?P<host_virtual_host_statsvn>[\w.-]*)(?P<_end>/statsvn/['"])
      * replacement: \g<_begin>\g<host_virtual_host_statsvn>\g<_end>
    * vritual host
      * match: (?P<_begin><a href=['"]https?://)(?P<host_virtual_host_trac>[\w.-]*)(?P<_end>/trac/['"])
      * replacement: \g<_begin>\g<host_virtual_host_trac>\g<_end>
    * vritual host
      * match: (?P<_begin><a href=['"]https?://)(?P<host_virtual_host_list>[\w.-]*)(?P<_end>/mailman/listinfo/['"])
      * replacement: \g<_begin>\g<host_virtual_host_list>\g<_end>
    * vritual host
      * match: (?P<_begin><a href=['"]https?://)(?P<host_virtual_host_gosa>[\w.-]*)(?P<_end>/.*\?login['"])
      * replacement: \g<_begin>\g<host_virtual_host_gosa>\g<_end>
    * vritual host
      * match: (?P<_begin><a href=['"]https?://)(?P<host_virtual_host_gosa>[\w.-]*)(?P<_end>/.*lostpwd.php['"])
      * replacement: \g<_begin>\g<host_virtual_host_gosa>\g<_end>

file: /etc/hosts
type: ip
regex:
    * cosign-client
      * match: ^(?:#\s*OPM/COMMENT\s*)?(?P<ip_cosign_client1>[0-9.]*)(?P<_end>\s+cosign-client1)\s*$
      * replacement(ip_cosign_client1,1): \g<ip_cosign_client1>\g<_end>
      * replacement(ip_cosign_client1,0): 127.0.0.3\g<_end>
      #* replacement(ip_cosign_client1,0): #OPM/COMMENT \g<_end>
