prefix=@prefix@
LOCALEDIR=@localedir@
DESTDIR=
INSTALL=     @INSTALL@

POFILES = $(wildcard */LC_MESSAGES/*.po)
MOFILES = $(POFILES:po=mo)
DOMAIN = cosign

all: mo


mo: $(MOFILES)
po: $(POFILES)
pot: $(DOMAIN).pot

$(DOMAIN).pot: $(wildcard ../cgi/*.c) ../cgi/cosigncgi.h
	xgettext --default-domain=$(DOMAIN) -L C -k_  \
		--no-location \
		-o $(DOMAIN).pot \
		$^

$(POFILES): $(DOMAIN).pot addition.pot
	msgmerge $@ $< -o $@.main
	msgmerge $@ addition.pot -o $@.sub
	msgcat -s -o $@ $@.main $@.sub
	-@rm -f $@.main $@.sub

%.mo: %.po
	msgfmt -o $@ $<

clean:
	-@find . -name "*.mo" | xargs rm

install : all
	-mkdir -p $(DESTDIR)${LOCALEDIR}
	cp -a . $(DESTDIR)${LOCALEDIR}

.PHONY: pot po mo $(DOMAIN).pot

# vim: noet ts=4 sw=4
