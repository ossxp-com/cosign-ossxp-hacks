directory: /opt/cosign/conf
type: backup

directory: /opt/cosign/factor
type: backup

directory: /opt/cosign/lib
type: backup

file: /opt/cosign/conf/cosign.conf
type: host
regex:
    ^set\s+cosignhost\s+(?P<host_cosign_daemon>.+)
    ^set\s+cosignlogouturl\s+https?://(?P<host_single_sign_on>[\w.-]+)/
    ^set\s+cosignloopurl\s+https?://(?P<host_single_sign_on>[\w.-]+)/

file: /etc/apache2/include/cosign/cosign-common.conf
type: host
regex:
    ^CosignHostname\s+(?P<host_cosign_daemon>.+)
    ^CosignRedirect\s+https?://(?P<host_single_sign_on>[\w.-]+)/
    ^CosignPostErrorRedirect\s+https?://(?P<host_single_sign_on>[\w.-]+)/

file: /etc/apache2/sites-available/cosign-cgi
regex:
    * server admin
      * match: (\bServerAdmin\s+)(?P<email_webmaster>.*)
      * replacement: \1\g<email_webmaster>
    * server name
      * match: (\bServerName\s+)(?P<host_single_sign_on>[\w.-]*)
      * replacement: \1\g<host_single_sign_on>
    * redirect
      * match: (\bRedirect\s+/\s+https://)(?P<host_single_sign_on>[\w.-]*)/
      * replacement: \1\g<host_single_sign_on>/

file: /opt/cosign/factor/ldap
type: host
regex:
    * ldap basedn
      * match: (\bmy\s+\$base\s*=\s*['"])(?P<name_ldap_basedn>[^'"]+)
      * replacement: \1\g<name_ldap_basedn>
    * ldap host
      * match: (?P<_begin>\bmy\s+\$host\s*=\s*['"]ldaps?://)(?P<host_ldap_server>[\w.-]+)(:(?P<number_ldap_port>[0-9]+))?(?P<_end>.+)$
      * replacement(number_ldap_port, 1): \g<_begin>\g<host_ldap_server>:\g<number_ldap_port>\g<_end>
      * replacement(number_ldap_port, 0): \g<_begin>\g<host_ldap_server>\g<_end>
    * ldap bind user
      * match: (?P<_begin>\bmy\s+\$binddn\s*=\s*['"])(?P<password_ldap_ro_binduser>[^'"]+)(?P<_end>.+)$
      * replacement: \g<_begin>\g<password_ldap_ro_binduser>\g<_end>
    * ldap bind password
      * match: (?P<_begin>\bmy\s+\$bindpw\s*=\s*['"])(?P<password_ldap_ro_bindpw>[^'"]+)(?P<_end>.+)$
      * replacement: \g<_begin>\g<password_ldap_ro_bindpw>\g<_end>

file: /opt/cosign/lib/services-local/config_inc.php
type: host, number
regex:
    \$url_gosa\s*=\s*['"]https?://(?P<host_virtual_host_gosa>[\w.-]+)/
    \$url_wiki\s*=\s*['"]https?://(?P<host_virtual_host_wiki>[\w.-]+)/
    \$url_websvn\s*=\s*['"]https?://(?P<host_virtual_host_websvn>[\w.-]+)/
    \$url_mercurial\s*=\s*['"]https?://(?P<host_virtual_host_hg>[\w.-]+)/
    \$url_statsvn\s*=\s*['"]https?://(?P<host_virtual_host_statsvn>[\w.-]+)/
    \$url_bugs\s*=\s*['"]https?://(?P<host_virtual_host_trac>[\w.-]+)/
    \$url_mailman\s*=\s*['"]https?://(?P<host_virtual_host_list>[\w.-]+)/
    \$url_login\s*=\s*['"]https?://(?P<host_single_sign_on>[\w.-]+)/
    \$url_logout\s*=\s*['"]https?://(?P<host_single_sign_on>[\w.-]+)/
    \$url_lostpwd\s*=\s*['"]https://(?P<host_virtual_host_gosa>[\w.-]+)/
    \$url_signup\s*=\s*['"]https?://(?P<host_virtual_host_gosa>[\w.-]+)/
    * ldap server
      * match: (\$g_ldap_server\s*=\s*['"]ldaps?://)(?P<host_ldap_server>[\w.-]+)(:(?P<number_ldap_port>[0-9]+))?
      * replacement(number_ldap_port, 1): \1\g<host_ldap_server>:\g<number_ldap_port>
      * replacement(number_ldap_port, 0): \1\g<host_ldap_server>
    * ldap port
      * match: (?P<_begin>\$g_ldap_port\s*=\s*['"])(?P<number_ldap_port>[0-9]+)
      * replacement: \g<_begin>\g<number_ldap_port>
    * ldap root dn
      * match: (\$g_ldap_root_dn\s*=\s*['"])(?P<name_ldap_basedn>[^'"]+)
      * replacement: \1\g<name_ldap_basedn>
    * ldap bind dn
      * match: (\$g_ldap_bind_dn\s*=\s*['"])(?P<password_ldap_ro_binduser>[^'"]+)
      * replacement: \1\g<password_ldap_ro_binduser>
    * ldap bind password
      * match: (\$g_ldap_bind_passwd\s*=\s*['"])(?P<password_ldap_ro_bindpw>[^'"]+)
      * replacement: \1\g<password_ldap_ro_bindpw>

file: /opt/cosign/lib/templates-local/expired_error.html, /opt/cosign/lib/templates-local/reauth.html, /opt/cosign/lib/templates-local/login.html, /opt/cosign/lib/templates-local/login_error.html
type: host
regex:
    ^\s+<a href=['"]https?://(?P<host_single_sign_on>[\w.-]+)/?['"]>$
    <a href=['"]https?://(?P<host_virtual_host_gosa>[\w.-]+)/.*signup.php['"]
    <a href=['"]https?://(?P<host_virtual_host_wiki>[\w.-]+)/.*action/login/.*\?action=login&login=1['"]
    <a href=['"]https?://(?P<host_virtual_host_websvn>[\w.-]+)/websvn/['"]
    <a href=['"]https?://(?P<host_virtual_host_statsvn>[\w.-]+)/statsvn/['"]
    <a href=['"]https?://(?P<host_virtual_host_trac>[\w.-]+)/trac/['"]
    <a href=['"]https?://(?P<host_virtual_host_list>[\w.-]+)/mailman/listinfo/['"]
    <a href=['"]https?://(?P<host_virtual_host_gosa>[\w.-]+)/.*\?login['"]
    <a href=['"]https?://(?P<host_virtual_host_gosa>[\w.-]+)/.*lostpwd.php['"]


file: /opt/cosign/lib/templates-local/zh/expired_error.html, /opt/cosign/lib/templates-local/zh/reauth.html, /opt/cosign/lib/templates-local/zh/login.html, /opt/cosign/lib/templates-local/zh/login_error.html
type: host
regex:
    ^\s+<a href=['"]https?://(?P<host_single_sign_on>[\w.-]+)/?['"]>$
    <a href=['"]https?://(?P<host_virtual_host_gosa>[\w.-]+)/.*signup.php['"]
    <a href=['"]https?://(?P<host_virtual_host_wiki>[\w.-]+)/.*action/login/.*\?action=login&login=1['"]
    <a href=['"]https?://(?P<host_virtual_host_websvn>[\w.-]+)/websvn/['"]
    <a href=['"]https?://(?P<host_virtual_host_statsvn>[\w.-]+)/statsvn/['"]
    <a href=['"]https?://(?P<host_virtual_host_trac>[\w.-]+)/trac/['"]
    <a href=['"]https?://(?P<host_virtual_host_list>[\w.-]+)/mailman/listinfo/['"]
    <a href=['"]https?://(?P<host_virtual_host_gosa>[\w.-]+)/.*\?login['"]
    <a href=['"]https?://(?P<host_virtual_host_gosa>[\w.-]+)/.*lostpwd.php['"]

file: /etc/hosts
type: ip
regex:
    * cosign-client
      * match: ^(?:#\s*OPM/COMMENT\s*)?(?P<ip_cosign_client1>[0-9.]+)(?P<_end>\s+cosign-client1)
      * replacement(ip_cosign_client1,1): \g<ip_cosign_client1>\g<_end>
      * replacement(ip_cosign_client1,0): 127.0.0.3\g<_end>
      #* replacement(ip_cosign_client1,0): #OPM/COMMENT \g<_end>
